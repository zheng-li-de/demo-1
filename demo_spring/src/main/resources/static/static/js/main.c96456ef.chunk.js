(this.webpackJsonpdemo_reactjs=this.webpackJsonpdemo_reactjs||[]).push([[0],{17:function(e,r,t){e.exports=t(40)},22:function(e,r,t){},40:function(e,r,t){"use strict";t.r(r);var n=t(0),a=t.n(n),o=t(16),l=t.n(o),i=(t(22),t(3)),c=(t(6),Object(n.createContext)({profile:null,hasLoginError:!1,getProfileError:!1,saveProfileError:!1,login:function(){return null},logout:function(){return null},getProfile:function(){return null},setProfile:function(){return null},dispatch:function(){return null}})),s=t(4),u=t.n(s);u.a.defaults.withCredentials=!0;var f={_handleErrorResponse:function(e){var r=e.data,t=null;return r&&r.error&&r.error.message?(t=new Error(r.error.message)).code=r.error.code:(t=new Error(e.statusText?e.statusText:"invalid error response")).code=e.status,t},login:function(e,r,t){var n,a=this;u.a.post("http://localhost:8080/login",{username:e,password:r}).then((function(e){})).catch((function(e){e.response?n=a._handleErrorResponse(e.response):(n=new Error(e.message)).code=-1})).then((function(){t(n)}))},getProfile:function(e,r){var t,n,a=this;u.a.get("http://localhost:8080/api/v1/profile/"+e).then((function(e){e.data?t=e.data:(n=new Error("invalid response")).code=0})).catch((function(e){e.response?n=a._handleErrorResponse(e.response):(n=new Error(e.message)).code=-1})).then((function(){r(n,t)}))},setProfile:function(e,r,t){var n,a,o=this;u.a.post("http://localhost:8080/api/v1/profile/"+e,r).then((function(e){e.data?n=e.data:(a=new Error("invalid response")).code=0})).catch((function(e){e.response?a=o._handleErrorResponse(e.response):(a=new Error(e.message)).code=-1})).then((function(){t(a,n)}))}},p=t(1),d={username:"",avatar:"",description:"",link:""},g={user:null,profile:d,hasLoginError:!1,getProfileError:!1,saveProfileError:!1},m=function(e,r){switch(r.type){case"login_success":return Object(p.a)(Object(p.a)({},e),{},{hasLoginError:!1,user:{id:1},profile:d});case"login_fail":return Object(p.a)(Object(p.a)({},e),{},{hasLoginError:!0,user:null,profile:d});case"logout":return Object(p.a)(Object(p.a)({},e),{},{user:null,profile:d});case"get_profile_success":return Object(p.a)(Object(p.a)({},e),{},{getProfileError:!1,profile:r.profile});case"get_profile_fail":return Object(p.a)(Object(p.a)({},e),{},{getProfileError:!0,profile:d});case"save_profile_success":return Object(p.a)(Object(p.a)({},e),{},{saveProfileError:!1});case"save_profile_fail":return Object(p.a)(Object(p.a)({},e),{},{saveProfileError:!0});case"set_profile_username":return Object(p.a)(Object(p.a)({},e),{},{profile:Object(p.a)(Object(p.a)({},e.profile),{},{username:r.username})});case"set_profile_avatar":return Object(p.a)(Object(p.a)({},e),{},{profile:Object(p.a)(Object(p.a)({},e.profile),{},{avatar:r.avatar})});case"set_profile_description":return Object(p.a)(Object(p.a)({},e),{},{profile:Object(p.a)(Object(p.a)({},e.profile),{},{description:r.description})});case"set_profile_link":return Object(p.a)(Object(p.a)({},e),{},{profile:Object(p.a)(Object(p.a)({},e.profile),{},{link:r.link})});default:throw new Error("Invalid action type: ".concat(r.type))}},v=t(5),h=function(){var e=Object(n.useContext)(c),r=e.user,t=e.profile,o=e.saveProfileError,l=e.getProfile,s=e.setProfile,u=e.logout,f=e.dispatch,p=Object(n.useState)(!1),d=Object(i.a)(p,2),g=d[0],m=d[1];Object(n.useEffect)((function(){l()}),[r.id]);var h=function(e){var r=e.target;f(Object(v.a)({type:"set_profile_"+r.name},r.name,r.value))};return a.a.createElement("div",{className:"login-form"},a.a.createElement("h1",null,"User Profile"),o&&a.a.createElement("div",{id:"error",className:"login-form-error"},"Save Failed"),a.a.createElement("fieldset",null,a.a.createElement("legend",null,"Profile"),a.a.createElement("label",null,a.a.createElement("span",null,"Username"),a.a.createElement("input",{name:"username",type:"text",value:t.username,onChange:h,placeholder:"username",required:!0})),a.a.createElement("label",null,a.a.createElement("span",null,"Description"),a.a.createElement("textarea",{name:"description",type:"text",value:t.description,onChange:h})),a.a.createElement("label",null,a.a.createElement("span",null,"Link"),a.a.createElement("input",{name:"link",type:"text",value:t.link,onChange:h})),a.a.createElement("label",null,a.a.createElement("span",null,"Avatar"),a.a.createElement("input",{name:"avatar",type:"text",value:t.avatar,onChange:h})),t.avatar&&a.a.createElement("img",{id:"avatar_img",src:t.avatar||"",width:"100",height:"100",alt:""})),a.a.createElement("button",{id:"save",onClick:function(){m(!0),s((function(){m(!1)}))},disabled:g},"Save"),a.a.createElement("br",null),a.a.createElement("button",{id:"logout",onClick:u},"Logout"))},E=function(){var e=Object(n.useContext)(c),r=e.login,t=e.hasLoginError,o=Object(n.useState)(""),l=Object(i.a)(o,2),s=l[0],u=l[1],f=Object(n.useState)(""),p=Object(i.a)(f,2),d=p[0],g=p[1],m=function(e){return function(r){e(r.target.value)}};return a.a.createElement("form",{className:"login-form",onSubmit:function(e){e.preventDefault(),r(s,d)}},a.a.createElement("h1",null,"Please Login"),t&&a.a.createElement("div",{id:"error",className:"login-form-error"},"Login Failed: Incorrect Credentials"),a.a.createElement("fieldset",null,a.a.createElement("legend",null,"Credentials"),a.a.createElement("label",null,a.a.createElement("span",null,"Username"),a.a.createElement("input",{type:"text",name:"username",value:s,onChange:m(u),placeholder:"username",required:!0})),a.a.createElement("label",null,a.a.createElement("span",null,"Password"),a.a.createElement("input",{type:"password",name:"password",value:d,onChange:m(g),placeholder:"password",required:!0}))),a.a.createElement("button",null,"Login"))};var b=function(){var e=Object(n.useReducer)(m,g),r=Object(i.a)(e,2),t=r[0],o=r[1],l={user:t.user,profile:t.profile,hasLoginError:t.hasLoginError,getProfileError:t.getProfileError,saveProfileError:t.saveProfileError,dispatch:o,login:function(e,r){f.login(e,r,(function(e){o(e?{type:"login_fail"}:{type:"login_success"})}))},logout:function(){return o({type:"logout"})},getProfile:function(e){f.getProfile(t.user.id,(function(r,t){o(r?{type:"get_profile_fail"}:{type:"get_profile_success",profile:t}),e&&e()}))},setProfile:function(e){f.setProfile(t.user.id,t.profile,(function(r){o(r?{type:"save_profile_fail"}:{type:"save_profile_success"}),e&&e()}))}};return a.a.createElement(c.Provider,{value:l},t.user&&a.a.createElement(h,null),!t.user&&a.a.createElement(E,null))},j=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function O(e,r){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;null!=t&&(t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?(console.log("New content is available and will be used when all tabs for this page are closed. See https://bit.ly/CRA-PWA."),r&&r.onUpdate&&r.onUpdate(e)):(console.log("Content is cached for offline use."),r&&r.onSuccess&&r.onSuccess(e)))})}})).catch((function(e){console.error("Error during service worker registration:",e)}))}l.a.render(a.a.createElement(a.a.StrictMode,null,a.a.createElement(b,null)),document.getElementById("root")),function(e){if("serviceWorker"in navigator){if(new URL("",window.location.href).origin!==window.location.origin)return;window.addEventListener("load",(function(){var r="".concat("","/service-worker.js");j?(!function(e,r){fetch(e,{headers:{"Service-Worker":"script"}}).then((function(t){var n=t.headers.get("content-type");404===t.status||null!=n&&-1===n.indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):O(e,r)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(r,e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://bit.ly/CRA-PWA")}))):O(r,e)}))}}()},6:function(e,r,t){}},[[17,1,2]]]);
//# sourceMappingURL=main.c96456ef.chunk.js.map